#This program uses GenAI to get the answers to your questions from documents

import gradio as gr
import langchain
from langchain.document_loaders import PyPDFLoader
import google.generativeai as ai

# Set your Gemini API key
ai.configure(api_key="secret!")

# Create a model instance
model = ai.GenerativeModel(model_name="gemini-1.5-pro")

# Create a Gradio interface
def process_query(query, pdf_file):
    if pdf_file:
        pdf_text = load_pdf(pdf_file)
        prompt = query + "\n" + pdf_text
    else:
        prompt = query

    response = model.generate_content(prompt)
    return response.text

def load_pdf(pdf_file):
    loader = PyPDFLoader(pdf_file)
    documents = loader.load()
    pdf_text = "\n".join([doc.page_content for doc in documents])
    return pdf_text

iface = gr.Interface(
    fn=process_query,
    inputs=[
        gr.Textbox(label="Your Question"),
        gr.File(label="Upload PDF (optional)")
    ],
    outputs=gr.Textbox(label="Response"),
    title="Question Your PDF Files",
    description="This program uses GenAI to get the answers to your questions from documents"
)

# Launch the Gradio app
if __name__ == "__main__":
    iface.launch(server_name="0.0.0.0", server_port=7860)
